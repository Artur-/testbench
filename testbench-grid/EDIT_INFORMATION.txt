Differences between TestBench and Selenium Grid 1.0.4

The differences between TestBench and Selenium version of the grid are in the handling of remote-controls.

TestBench Grid group the remote controls by their hash value (consists of ip+port) where the original Selenium implementation groups them by their environment.

TestBench also restricts the remote controls so that they may only run one test at a time.

TestBench enables remote controls to register multiple environments when they are started where as the original implementation only allows one environment/remote control.

TestBench also adds some load balancing by checking which remote control has the least waiting reservations and by allowing tests to search for another remote controller in the case they fail to reserve the remote controller they are waiting for after a number of tries (another test is faster and gets the remote control).


Changed files.

hub:
	com.thoughtworks.selenium.grid.hub.remotecontrol.DynamicRemoteControlPool	[]
	com.thoughtworks.selenium.grid.hub.remotecontrol.GlobalRemoteControlPool	[multiple environments, grouping, load balancing]
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProvsioner	[group handling, load balancing]
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProxy			[equals(Object), toString()]

	
Changed files for RemoteControl reregistration #3685
rc:
	com.thoughtworks.selenium.grid.remotecontrol.SelfRegisteringRemoteControl	[Timer]
hub:
	com.thoughtworks.selenium.grid.hub.management.RegistrationConfirmationServlet [new file for confirming that RC is registered]
	com.thoughtworks.selenium.grid.hub.remotecontrol.DynamicRemoteControlPool	[]
	com.thoughtworks.selenium.grid.hub.remotecontrol.GlobalRemoteControlPool	[status and checkRegistartion methods]
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProvsioner	[confirm method]
	
Changed files for timeout watchdog #3610(?)

infrastructure:
	com.thoughtworks.selenium.grid.HttpClient [inUse flag]
hub:
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProxy			[WatchDog timer]
	com.thoughtworks.selenium.grid.hub.remotecontrol.GlobalRemoteControlPool	[Givee session to RC]
	
Using selenium-server-1.0.1.jar


======================

Updates when eliminating duplicated selenium-grid code:

Use as much as possible the latest (1.0.6 at the time of writing) Selenium Grid project, only override when necessary.
When overriding, copy only the required classes.
The original source code can be obtained at git://github.com/ph7/selenium-grid.git .

Note that the infrastructure (core) JAR was built from the standard Selenium grid sources as it is not in the distribution as a separate JAR.

rc:
    com.thoughtworks.selenium.grid.remotecontrol.OptionParser                   [changed defaults to no host, 60s polling interval, use ConfigurationParser]
    com.thoughtworks.selenium.grid.remotecontrol.ConfigurationParser            [new class for parsing rc_configuration.xml]
    com.thoughtworks.selenium.grid.remotecontrol.instrumentation.Response       [added Content-Length to response]

    build.xml

infrastructure/core (changes embedded in grid/hub):
    grid_configuration.yml
	com.thoughtworks.selenium.grid.HttpClient									[socket timeout, getResponseBodyAsStream instead of getResponseBody]

hub:
	com.thoughtworks.selenium.grid.hub.HeartbeatServlet                         [get host from remote address if not given]
	com.thoughtworks.selenium.grid.hub.HubServlet                               [reduced excessive logging]
	com.thoughtworks.selenium.grid.hub.management.RegistrationServlet			[multiple environments]
	com.thoughtworks.selenium.grid.hub.management.RemoteControlParser			[Support environment string parsing]
	com.thoughtworks.selenium.grid.hub.management.UnregistrationServlet			[multiple environments]

	com.thoughtworks.selenium.grid.hub.management.console.index.html			[names]

    build.xml

	com.thoughtworks.selenium.grid.hub.remotecontrol.GlobalRemoteControlPool	[multiple environments, grouping, load balancing]
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProvsioner	[group handling, load balancing]
	com.thoughtworks.selenium.grid.hub.remotecontrol.RemoteControlProxy			[equals(Object), toString()]


Changed files for proper process killing and cleanup #4277 and #4111
rc:
	com.thoughtworks.selenium.grid.remotecontrol.HubPoller                      [cleanup current test if hub cannot be reached]
    org.openqa.selenium.server.SeleniumServer                                   [copied from selenium-server-1.0.1, added stopAllBrowsers()]
    org.openqa.selenium.server.browserlaunchers.AsyncExecute                    [copied from selenium-server-1.0.1 and modified killProcess()]
    org.openqa.selenium.server.browserlaunchers.SafariCustomProfileLauncher     [copied from selenium-server-1.0.1, added profile cleanup in close()]
